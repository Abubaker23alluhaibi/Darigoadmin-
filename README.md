# لوحة إدارة داريكو

## المميزات

✅ **صفحات منظمة ومنفصلة:**
- 🏠 **الرئيسية**: عرض الإحصائيات العامة والنشاط الأخير
- 👥 **إدارة المستخدمين**: عرض وإدارة جميع المستخدمين مع إمكانية البحث والتصفية
- 🏘️ **إدارة العقارات**: مراجعة واعتماد العقارات المضافة
- 📊 **الإحصائيات**: رسوم بيانية مفصلة عن النظام
- ⚙️ **الإعدادات**: إعدادات النظام العامة

✅ **واجهة مستخدم متقدمة:**
- تصميم عصري ومتجاوب مع ألوان التطبيق الأصلية
- شريط جانبي قابل للطي
- جداول بيانات مع إمكانية البحث والتصفية
- نظام تنبيهات وإشعارات
- نوافذ منبثقة للتأكيد

✅ **أمان متقدم:**
- نظام مصادقة JWT
- التحقق من صلاحيات المدير
- حماية جميع API endpoints

## ألوان التطبيق المستخدمة

🎨 **الألوان الرئيسية:**
- **الأخضر الداكن**: `#304F2F` - للعناصر الأساسية والشريط الجانبي
- **الأخضر الفاتح**: `#E2DECE` - للنصوص على الخلفية الداكنة
- **الأخضر للنجاح**: `#28A745` - للإجراءات الإيجابية
- **الأصفر للتحذير**: `#FFC107` - للتنبيهات
- **الأحمر للأخطاء**: `#DC3545` - للأخطاء والتحذيرات
- **الأزرق للمعلومات**: `#17A2B8` - للمعلومات الإضافية

## كيفية الاستخدام

### 1. تشغيل الخادم
```bash
cd Darigo
npm run server
```

### 2. الوصول للوحة الإدارة
افتح المتصفح واذهب إلى: `http://localhost:3001/admin/`

### 3. تسجيل الدخول

#### 🔑 **حسابات المدير:**
- **البريد الإلكتروني**: admin@darigo.com
- **كلمة المرور**: admin123

#### 👤 **حسابات المستخدمين للاختبار:**
- **مستخدم عادي:**
  - البريد: ahmed@example.com
  - كلمة المرور: user123

- **مكتب عقاري:**
  - البريد: fatima@example.com
  - كلمة المرور: agent123

## الملفات المنشأة

```
admin/
├── index.html          # الصفحة الرئيسية الكاملة
├── preview.html        # معاينة بدون قاعدة بيانات
├── css/admin.css       # ملف التصميم مع ألوان التطبيق
├── js/admin.js         # ملف الوظائف الكامل
└── README.md           # دليل الاستخدام
```

## API Endpoints المتاحة

### إدارة المستخدمين
- `GET /api/admin/users` - جلب جميع المستخدمين
- `PATCH /api/admin/users/:id/toggle-status` - تبديل حالة المستخدم

### إدارة العقارات
- `GET /api/admin/properties` - جلب جميع العقارات
- `PATCH /api/admin/properties/:id/status` - تحديث حالة العقار
- `DELETE /api/admin/properties/:id` - حذف العقار

### الإحصائيات
- `GET /api/admin/stats` - جلب الإحصائيات العامة

## المتطلبات

- Node.js
- MongoDB (محلي أو Atlas)
- متصفح حديث يدعم JavaScript ES6+

## استكشاف الأخطاء

### 🔧 **مشاكل تسجيل الدخول الشائعة:**

#### 1. **"الحساب غير نشط"**
```bash
# تشغيل هذا الأمر لتفعيل جميع المستخدمين
node debug-login.js
```

#### 2. **"المستخدم غير موجود"**
تأكد من:
- تشغيل MongoDB
- تشغيل الخادم
- استخدام البريد الإلكتروني الصحيح

#### 3. **"كلمة المرور غير صحيحة"**
تأكد من استخدام كلمة المرور الصحيحة:
- المدير: admin123
- المستخدم العادي: user123
- المكتب العقاري: agent123

#### 4. **التطبيق يعود لصفحة تسجيل الدخول**
هذه المشكلة تم حلها في التحديث الأخير:
- تم تحسين حفظ الرمز المميز
- تم إضافة آلية احتياطية للبيانات المحفوظة محلياً
- تم إصلاح مشكلة التحقق من الرمز المميز

### 🛠️ **إصلاحات تم تطبيقها:**

1. **تحسين حفظ الرمز المميز**: تم إصلاح مشكلة عدم حفظ الرمز المميز بشكل صحيح
2. **آلية احتياطية**: إذا فشل التحقق من الرمز المميز، يستخدم التطبيق البيانات المحفوظة محلياً
3. **معالجة أفضل للأخطاء**: تم تحسين معالجة أخطاء الشبكة والاتصال

### 📱 **للتطبيق المحمول:**

إذا كنت تواجه مشاكل في التطبيق المحمول:
1. **امسح بيانات التطبيق** من إعدادات الهاتف
2. **أعد تشغيل التطبيق**
3. **جرب تسجيل الدخول مرة أخرى**

## ملاحظات مهمة

1. **تأكد من تشغيل MongoDB** قبل تشغيل الخادم
2. **غير كلمة مرور المدير** في الإنتاج
3. **أضف SSL** للاتصال الآمن في الإنتاج
4. **احتفظ بنسخة احتياطية** من قاعدة البيانات

## الدعم

إذا واجهت أي مشاكل، تأكد من:
- تشغيل MongoDB
- تشغيل الخادم على المنفذ 3001
- وجود اتصال إنترنت للوصول للخطوط والرموز
- استخدام البيانات الصحيحة لتسجيل الدخول

### 📞 **للحصول على مساعدة إضافية:**
1. تحقق من ملف `debug-login.js` لفحص حالة المستخدمين
2. راجع سجلات الخادم للأخطاء
3. تأكد من أن جميع الخدمات تعمل بشكل صحيح